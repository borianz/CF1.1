<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>indexDB</title>
    <script src='js/IndexDB.js'></script>
</head>
<body>
<input type="button" onclick="init();" value="indexedDB">
<script>
    function book(name,authoer,no)
    {
        return {author:authoer,name:name,no:no};
    }
    function init(){
var books=[book('看见','jake',1),book('幸福了吗','jake',2),book('少有人走的路','mike',3)];
        var newbooks=[book('看见2','jake',4),book('幸福了吗2','jake',5),book('少有人走的路2','mike',6)];
        new dbRequest('trial').openFunc(function(db){
              db.writeTransaction('books').events(
                      function(e)
                      {
                         alert('trans success'+e);
                      },function(e)
                      {
                          alert('trans abort'+e);
                      },
                      function(e)
                      {
                          alert('trans error'+e);
                      }
              ).store.forEach(function(cursor){
                          alert(cursor.value.name);
                      },function(cursor){
                          return true;
                      });
        }).changeFunc(function(db){
                    db.deleteStore('books');
                    db.createStore('books','no',true,[storeIndex('ix_author','author',false,true),storeIndex('ix_name','name',true,false)],books);
                }).errorFunc(function(e){
                    alert(e);
                });
    }

</script>
</body>
</html>